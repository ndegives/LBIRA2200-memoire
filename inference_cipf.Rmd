---
title: "Titre"
author: "Degives Nicolas"
date: "Date"
output:
  html_document:
    code_folding: show
    collapsed: yes
    fig_caption: yes
    fig_height: 5
    fig_width: 6
    highlight: tango
    number_sections: yes
    smart: no
    theme: united
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '2'
    number_sections: yes
editor_options:
  chunk_output_type: console
---
  
```{r setup, include=FALSE}
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)

```

# Load and prepare the Data

## Import 

```{r, echo=TRUE}
data<- read_excel("Sorgho20_21_22_CIPF.xlsx")
head(data)
```

## Sort the columns

```{r, echo=TRUE}
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
```

# Condition météo

```{r, echo=TRUE}
meteo <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")

mean_culture_rain <- c(
  mean((subset(meteo,annee==2020)$mean_rain)),
  mean((subset(meteo,annee==2021)$mean_rain)),
  mean((subset(meteo,annee==2022)$mean_rain))
)
mean_culture_rain <- data.frame(c(2020,2021,2022),mean_culture_rain)

#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
  facet_wrap(~annee)+
  geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
  labs(title = "Temperature et pluviometrie")

#Plot temperature
ggplot(data = meteo, aes(x=Mois))+
  facet_wrap(~annee)+
  geom_col(aes(y=mean_temp,width=0.5),fill='red')+
  labs(title='Temperature')

```

# Inference sur les varietes

```{r, echo=TRUE}
ggplot(data=data,aes(x=variete,y=rendement_MS))+
  geom_bar(stat = 'identity')+ facet_wrap(~annee)+
  labs(x='Variété',
       y='rendement [T/ha]')
```

# Rendement des genotype par annee

```{r, echo=TRUE}
ggplot(data=data,aes(x=as.factor(annee),y=rendement_MS))+
  geom_bar(stat='identity')+
  facet_wrap(~variete)+
  labs(x='annee',
       y='rendement')
```