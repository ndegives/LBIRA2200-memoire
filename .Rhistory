mutate(diameter=diameter*10) %>%
diameter_outliers(.) %>%
rbind(lateral.clean,.) -> lateral.clean
}
lateral.clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
filter(end.data, variety==variete,root_ontology==' Lateral root') %>%
mutate(diameter=diameter*10) %>%
diameter_outliers(.) %>%
rbind(lateral.clean,.) -> lateral.clean
}
View(lateral.clean)
lateral.clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
filter(end.data, variety==variete,root_ontology==' Lateral root') %>%
mutate(diameter=diameter*10) %>%
mutate(parent_diameter=parent_diameter*10) %>%
diameter_outliers(.) %>%
rbind(lateral.clean,.) -> lateral.clean
}
View(lateral.clean)
lateral.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
labs(x='Diamètre racines parentes [mm]',y='Diamètre racine fille [mm]',col='variété')+
scale_y_continuous(limits = c(0,0.7))
mod_DIDm <- lm(diameter~variety*parent_diameter,data=lateral.clean)
pander(summary(mod_DIDm))
pander(anova(mod_DIDm))
pander(summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Biggben'))))
mod_DIDm <- lm(diameter~variety*parent_diameter,data=lateral.clean)
pander(summary(mod_DIDm))
pander(anova(mod_DIDm))
pander(summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Biggben'))))
par(mfrow=c(2,2))
plot(mod_DIDm)
par(mfrow=c(1,1))
pander(leveneTest(mod_DIDm, center = "median"))
lsm <- lsmeans(mod_min, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter)*10)
par(mfrow=c(2,2))
plot(mod_DIDm)
par(mfrow=c(1,1))
pander(leveneTest(mod_DIDm, center = "median"))
branching <- early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
branching %>%
ggplot(aes(x=variety,y=IBD*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',x='variété',y='IBD [mm]')+
theme_gray()
mod_IBD <- lm(IBD*10 ~ variety, data=branching)
pander(summary(mod_IBD))
pander(anova(mod_IBD))
par(mfrow = c(2,2))
plot(mod_IBD)
par(mfrow = c(1,1))
pander(leveneTest(mod_IBD, center = "median"))
lsm <- lsmeans(mod_IBD, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
contrast(lsm)
hypothesis <- list("Amiggo = Vegga" = c(1,0,0,0,0,-1))
contrast(lsm$lsmeans, hypothesis)
lsm <- lsmeans(mod_IBD, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
hypothesis <- list("Amiggo = Vegga" = c(1,0,0,0,0,-1))
contrast(lsm$lsmeans, hypothesis)
lsm <- lsmeans(mod_IBD, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
hypothesis <- list("Amiggo = Vegga" = c(1,0,0,0,0,-1),
"Biggben = Vegga" = c(0,1,0,0,0,-1),
"Hyperion = Vegga" = c(0,0,1,0,0,-1),
"Juno = Vegga" = c(0,0,0,1,0,-1),
"Swingg = Vegga" = c(0,0,0,0,1,-1))
contrast(lsm$lsmeans, hypothesis)
pander(contrast(lsm$lsmeans, hypothesis))
lsm <- lsmeans(mod_IBD, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
hypothesis <- list("Amiggo = Vegga" = c(1,0,0,0,0,-1),
"Biggben = Vegga" = c(0,1,0,0,0,-1),
"Hyperion = Vegga" = c(0,0,1,0,0,-1),
"Juno = Vegga" = c(0,0,0,1,0,-1),
"Swingg = Vegga" = c(0,0,0,0,1,-1))
pander(contrast(lsm$lsmeans, hypothesis))
contrast(lsm$lsmeans, hypothesis)
lsm <- lsmeans(mod_IBD, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
hypothesis <- list("Amiggo - Vegga = 0" = c(1,0,0,0,0,-1),
"Biggben - Vegga = 0" = c(0,1,0,0,0,-1),
"Hyperion - Vegga = 0" = c(0,0,1,0,0,-1),
"Juno - Vegga = 0" = c(0,0,0,1,0,-1),
"Swingg - Vegga = 0" = c(0,0,0,0,1,-1))
contrast(lsm$lsmeans, hypothesis)
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
library(lsmeans)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
# Chunk 9
ggplot(data=Dmin_clean, aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution de la latérale la plus fine pour chaque racine nodale en fonction de la variété de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 10
mod_min <- lm(diameter*10 ~ variety, data = Dmin_clean)
pander(summary(mod_min))
pander(anova(mod_min))
# Chunk 11
par(mfrow=c(2,2))
plot(mod_min)
par(mfrow=c(1,1))
pander(leveneTest(mod_min, center = "median"))
# Chunk 12
lsm <- lsmeans(mod_min, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter)*10)
# Chunk 13
nodal_clean <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Chunk 14
nodal_clean %>%
ggplot(aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution des diamètre de nodale en fonction de la variétés de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 15
mod_max <- lm(diameter*10 ~ variety, data=nodal_clean)
pander(summary(mod_max))
pander(anova(mod_max))
# Chunk 16
par(mfrow = c(2,2))
plot(mod_max)
par(mfrow = c(1,1))
pander(leveneTest(mod_max, center = "median"))
# Chunk 17
lsm <- lsmeans(mod_max, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
Dmax <- max(nodal_clean$diameter)*10
paste('Le Dmax global pour les six variétés est',Dmax)
# Chunk 18
Drange <- aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min) %>%
mutate(Drange=2*(parent_diameter-diameter)/(parent_diameter+diameter))
Drange_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Drange, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Drange_clean,.) -> Drange_clean
}
# Chunk 19
Drange_clean %>%
ggplot(aes(x=variety,y=Drange))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_gray()
mod_range <- lm(Drange ~ variety, data=Drange_clean)
pander(summary(mod_range))
pander(anova(mod_range))
lsm <- lsmeans(mod_range, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Juno =',
mean(subset(Drange_clean,!(variety=='Juno'))$Drange))
Drange_clean %>%
ggplot(aes(x=variety,y=Drange))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_gray()
mod_range <- lm(Drange ~ variety, data=Drange_clean)
pander(summary(mod_range))
pander(anova(mod_range))
par(mfrow = c(2,2))
plot(mod_range)
par(mfrow = c(1,1))
pander(leveneTest(mod_range, center = "median"))
lsm <- lsmeans(mod_range, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Juno =',
mean(subset(Drange_clean,!(variety=='Juno'))$Drange))
mean(Drange_clean$Drange)
paste('La moyenne de toute les variétés =',
mean(Drange_clean$Drange))
paste('IBD moyen pour les six variété =',mean(branching$IBD))
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
library(lsmeans)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
# Chunk 9
ggplot(data=Dmin_clean, aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution de la latérale la plus fine pour chaque racine nodale en fonction de la variété de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 10
mod_min <- lm(diameter*10 ~ variety, data = Dmin_clean)
pander(summary(mod_min))
pander(anova(mod_min))
# Chunk 11
par(mfrow=c(2,2))
plot(mod_min)
par(mfrow=c(1,1))
pander(leveneTest(mod_min, center = "median"))
# Chunk 12
lsm <- lsmeans(mod_min, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter)*10)
# Chunk 13
nodal_clean <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Chunk 14
nodal_clean %>%
ggplot(aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution des diamètre de nodale en fonction de la variétés de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 15
mod_max <- lm(diameter*10 ~ variety, data=nodal_clean)
pander(summary(mod_max))
pander(anova(mod_max))
# Chunk 16
par(mfrow = c(2,2))
plot(mod_max)
par(mfrow = c(1,1))
pander(leveneTest(mod_max, center = "median"))
# Chunk 17
lsm <- lsmeans(mod_max, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
Dmax <- max(nodal_clean$diameter)*10
paste('Le Dmax global pour les six variétés est',Dmax)
# Chunk 18
Drange <- aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min) %>%
mutate(Drange=2*(parent_diameter-diameter)/(parent_diameter+diameter))
Drange_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Drange, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Drange_clean,.) -> Drange_clean
}
# Chunk 19
Drange_clean %>%
ggplot(aes(x=variety,y=Drange))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_gray()
# Chunk 20
mod_range <- lm(Drange ~ variety, data=Drange_clean)
pander(summary(mod_range))
pander(anova(mod_range))
# Chunk 21
par(mfrow = c(2,2))
plot(mod_range)
par(mfrow = c(1,1))
pander(leveneTest(mod_range, center = "median"))
# Chunk 22
lsm <- lsmeans(mod_range, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés =',
mean(Drange_clean$Drange))
# Chunk 23
branching <- early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
# Chunk 24
branching %>%
ggplot(aes(x=variety,y=IBD*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',x='variété',y='IBD [mm]')+
theme_gray()
# Chunk 25
mod_IBD <- lm(IBD*10 ~ variety, data=branching)
pander(summary(mod_IBD))
pander(anova(mod_IBD))
# Chunk 26
par(mfrow = c(2,2))
plot(mod_IBD)
par(mfrow = c(1,1))
pander(leveneTest(mod_IBD, center = "median"))
paste('IBD moyen pour les six variété =',mean(branching$IBD))
paste('IBD moyen pour les six variété =',mean(branching$IBD)*10)
lateral.clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
filter(end.data, variety==variete,root_ontology==' Lateral root') %>%
mutate(diameter=diameter*10) %>%
mutate(parent_diameter=parent_diameter*10) %>%
diameter_outliers(.) %>%
rbind(lateral.clean,.) -> lateral.clean
}
lateral.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
labs(x='Diamètre racines parentes [mm]',y='Diamètre racine fille [mm]',col='variété')+
scale_y_continuous(limits = c(0,0.7))
mod_DIDm <- lm(diameter~variety*parent_diameter,data=lateral.clean)
pander(summary(mod_DIDm))
pander(anova(mod_DIDm))
pander(summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Biggben'))))
lateral.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
labs(x='Diamètre racines parentes [mm]',y='Diamètre racine fille [mm]',col='variété')+
scale_y_continuous(limits = c(0,0.7))
mod_DIDm <- lm(diameter~offset(min(diameter)-min(diameter))*variety*parent_diameter,data=lateral.clean)
mod_DIDm <- lm(diameter~offset(min(diameter)-min(diameter))+variety*parent_diameter,data=lateral.clean)
min_dia <- min(diameter)
min_dia <- min(lateral.clean$diameter)
mod_DIDm <- lm(diameter~offset(min_dia-min_dia)+variety*parent_diameter,data=lateral.clean)
mod_DIDm <- lm(diameter~offset(min_dia,min_dia)+variety*parent_diameter,data=lateral.clean)
mod_DIDm <- lm(diameter~offset(min_dia - min_dia)+variety*parent_diameter,data=lateral.clean)
mean(subset(end.data,variety=='Hyperion')$ratio.diameter)
mean(subset(end.data,variety=='Hyperion')$ratio_diameter)
mean(na.omit(subset(end.data,variety=='Hyperion')$ratio_diameter))
pander(anova(mod_DIDm))
lateral.clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
filter(end.data, variety==variete,root_ontology==' Lateral root') %>%
mutate(diameter=diameter*10) %>%
mutate(parent_diameter=parent_diameter*10) %>%
diameter_outliers(.) %>%
rbind(lateral.clean,.) -> lateral.clean
}
lateral.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
labs(x='Diamètre racines parentes [mm]',y='Diamètre racine fille [mm]',col='variété')+
scale_y_continuous(limits = c(0,0.7))
min_dia <- min(lateral.clean$diameter)
mod_DIDm <- lm(diameter~variety*parent_diameter,data=lateral.clean)
pander(summary(mod_DIDm))
pander(anova(mod_DIDm))
pander(summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Biggben'))))
min_dia <- min(lateral.clean$diameter)
mod_DIDm <- lm(diameter~variety*parent_diameter,data=lateral.clean)
pander(summary(mod_DIDm))
pander(anova(mod_DIDm))
pander(summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Biggben'))))
summary(mod_DIDm)
pander(summary(mod_DIDm))
cat(summary(mod_DIDm))
paste(summary(mod_DIDm))
clear
help("pander")
pander(summary(mod_DIDm),split.tables=F)
pander(summary(mod_DIDm),split.tables=T)
lateral.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
labs(x='Diamètre racines parentes [mm]',y='Diamètre racine fille [mm]',col='variété')+
scale_y_continuous(limits = c(0,0.7))
