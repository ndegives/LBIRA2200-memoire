labs(title='Drange')+
theme_classic()
branching %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',x='variété',y='IBD [cm]')+
theme_classic()
View(end.data)
View(early.data)
1/7.5
branching %>%
ggplot(aes(x=variety,y=IBD*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',x='variété',y='IBD [mm]')+
theme_classic()
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
library(lsmeans)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
# Chunk 9
ggplot(data=Dmin_clean, aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution de la latérale la plus fine pour chaque racine nodale en fonction de la variété de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 10
mod_min <- lm(diameter ~ variety, data = Dmin_clean)
pander(summary(mod_min))
pander(anova(mod_min))
# Chunk 11
par(mfrow=c(2,2))
plot(mod_min)
par(mfrow=c(1,1))
pander(leveneTest(mod_min, center = "median"))
# Chunk 12
lsm <- lsmeans(mod_min, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter))
# Chunk 13
nodal_clean <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
nodal_clean %>%
ggplot(aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution des diamètre de nodale en fonction de la variétés de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_classic()
nodal_clean %>%
ggplot(aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution des diamètre de nodale en fonction de la variétés de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
library(lsmeans)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
# Chunk 9
ggplot(data=Dmin_clean, aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution de la latérale la plus fine pour chaque racine nodale en fonction de la variété de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 10
mod_min <- lm(diameter ~ variety, data = Dmin_clean)
pander(summary(mod_min))
pander(anova(mod_min))
# Chunk 11
par(mfrow=c(2,2))
plot(mod_min)
par(mfrow=c(1,1))
pander(leveneTest(mod_min, center = "median"))
# Chunk 12
lsm <- lsmeans(mod_min, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter))
# Chunk 13
nodal_clean <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
nodal_clean %>%
ggplot(aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution des diamètre de nodale en fonction de la variétés de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
ggplot(data=Dmin_clean, aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution de la latérale la plus fine pour chaque racine nodale en fonction de la variété de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
Drange_clean %>%
ggplot(aes(x=variety,y=Drange))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_gray()
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
library(lsmeans)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
# Chunk 9
ggplot(data=Dmin_clean, aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution de la latérale la plus fine pour chaque racine nodale en fonction de la variété de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 10
mod_min <- lm(diameter ~ variety, data = Dmin_clean)
pander(summary(mod_min))
pander(anova(mod_min))
# Chunk 11
par(mfrow=c(2,2))
plot(mod_min)
par(mfrow=c(1,1))
pander(leveneTest(mod_min, center = "median"))
# Chunk 12
lsm <- lsmeans(mod_min, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter))
# Chunk 13
nodal_clean <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Chunk 14
nodal_clean %>%
ggplot(aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution des diamètre de nodale en fonction de la variétés de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 15
mod_max <- lm(diameter ~ variety, data=nodal_clean)
pander(summary(mod_max))
pander(anova(mod_max))
# Chunk 16
par(mfrow = c(2,2))
plot(mod_max)
par(mfrow = c(1,1))
pander(leveneTest(mod_max, center = "median"))
# Chunk 17
Dmax <- max(nodal_clean$diameter)
paste('Le Dmax global pour les six variétés est',Dmax)
# Chunk 18
Drange <- aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min) %>%
mutate(Drange=2*(parent_diameter-diameter)/(parent_diameter+diameter))
Drange_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Drange, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Drange_clean,.) -> Drange_clean
}
Drange_clean %>%
ggplot(aes(x=variety,y=Drange))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_gray()
mod_range <- lm(Drange ~ variety, data=Drange_clean)
pander(summary(mod_range))
pander(anova(mod_range))
lsm <- lsmeans(mod_range, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Juno =',
mean(subset(Drange_clean,!(variety=='Juno'))$Drange))
lsm <- lsmeans(mod_max, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
Dmax <- max(nodal_clean$diameter)
paste('Le Dmax global pour les six variétés est',Dmax)
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
library(lsmeans)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
# Chunk 9
ggplot(data=Dmin_clean, aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution de la latérale la plus fine pour chaque racine nodale en fonction de la variété de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 10
mod_min <- lm(diameter ~ variety, data = Dmin_clean)
pander(summary(mod_min))
pander(anova(mod_min))
# Chunk 11
par(mfrow=c(2,2))
plot(mod_min)
par(mfrow=c(1,1))
pander(leveneTest(mod_min, center = "median"))
# Chunk 12
lsm <- lsmeans(mod_min, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter))
# Chunk 13
nodal_clean <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Chunk 14
nodal_clean %>%
ggplot(aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution des diamètre de nodale en fonction de la variétés de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
# Chunk 15
mod_max <- lm(diameter ~ variety, data=nodal_clean)
pander(summary(mod_max))
pander(anova(mod_max))
# Chunk 16
par(mfrow = c(2,2))
plot(mod_max)
par(mfrow = c(1,1))
pander(leveneTest(mod_max, center = "median"))
lsm <- lsmeans(mod_max, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
Dmax <- max(nodal_clean$diameter)
paste('Le Dmax global pour les six variétés est',Dmax)
nodal_clean %>%
ggplot(aes(x=variety,y=diameter*10))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Distribution des diamètre de nodale en fonction de la variétés de sorgho',
x='Variété', y='Diamètre [mm]')+
theme_gray()
lsm <- lsmeans(mod_min, pairwise ~ variety)
pander(summary(lsm))
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter))
