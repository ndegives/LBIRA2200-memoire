select('root_name','root','diameter','root_ontology','parent','parent_name','variety') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
View(early.data)
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
# Fichier avec nombre par noeud
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
node$variety = as.factor(node$variety)
View(end.data)
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
# Fichier avec nombre par noeud
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
node$variety = as.factor(node$variety)
View(end.data)
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
rm(early.global)
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
View(early.growth)
View(early.growth)
early.growth %>%
subset(root_ontology=' Root')
early.growth %>%
subset(root_ontology='Root')
early.growth %>%
subset(root_ontology='
Root')
early.growth %>%
subset(root_ontology==' Root')
early.growth %>%
subset(root_ontology=='Root')
early.growth %>%
subset(root_ontology==" Root")
early.growth %>%
subset(root_ontology==" Root")
early.growth %>%
subset(root_ontology=="  Root")
colnames(early.growth)
early.growth %>%
subset(root_ontology=="  Root") %>%
group_by(root)
early.growth %>%
subset(root_ontology=="  Root") %>%
group_by(root) %>%
filter(date == max(date))
early.growth %>%
subset(root_ontology=="  Root") %>%
group_by(root) %>%
filter(date == max(date))
print(n=60)
View(early.growth)
early.growth %>%
subset(root_ontology=="  Root",root_name=='root_0') %>%
group_by(root) %>%
filter(date == max(date))
early.growth %>%
subset(root_ontology=="  Root",root_name=='root_0') %>%
group_by(root) %>%
filter(date == max(date))
early.growth %>%
subset(root_name=='root_0') %>%
group_by(root) %>%
filter(date == max(date))
early.growth %>%
subset(root_name=='root_0') %>%
group_by(root) %>%
filter(date == max(date))
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
filter(date == max(date))
early.growth %>%
subset(root_ontology=="  Root",root_name==' root_0') %>%
group_by(root) %>%
filter(date == max(date))
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
filter(date == max(date))
View(early.growth)
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root)
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
filter(date == max(date))
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root)
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit()
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date))
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_
))
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
select('root','position','date','variety')
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
mutate(growth = position/date) %>%
select('variety','root','position','date','growth')
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ factor("Amiggo"),
grepl("B", image) ~ factor("Biggben"),
grepl("H", image) ~ factor("Hyperion"),
grepl("J", image) ~ factor("Juno"),
grepl("S", image) ~ factor("Swingg"),
grepl("V", image) ~ factor("Vegga"),
TRUE ~ NA_character_ )) %>%
mutate(growth = position/date) %>%
select('variety','root','position','date','growth') ->early.growth
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
mutate(variety=as.factor(variety)) %>%
mutate(growth = position/date) %>%
select('variety','root','position','date','growth')
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
mutate(variety=as.factor(variety)) %>%
mutate(growth = position/date) %>%
select('variety','root','position','date','growth') -> early.growth
subset(early.growth) %>%
ggplot(aes(x=variety,y=growth))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Primary root')+
theme_classic()
subset(early.growth) %>%
ggplot(aes(x=variety,y=growth))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(x= 'd',
title='Primary root grotwh ')+
theme_classic()
?labs
subset(early.growth) %>%
ggplot(aes(x=variety,y=growth))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(xlab='g',
title='Primary root grotwh ')+
theme_classic()
subset(early.growth) %>%
ggplot(aes(x=variety,y=growth))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(xlabel='g',
title='Primary root grotwh ')+
theme_classic()
subset(early.growth) %>%
ggplot(aes(x=variety,y=growth))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(x='g',
title='Primary root grotwh ')+
theme_classic()
subset(early.growth) %>%
ggplot(aes(x=variety,y=growth))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(x='variete',
y='growth [cm/day]',
title='Primary root grotwh ')+
theme_classic()
early.growth %>%
lm(growth ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
rm(early.global)
View(early.data)
View(early.growth)
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
View(early.growth)
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
mutate(variety=as.factor(variety)) %>%
mutate(growth = position/date) %>%
select('variety','root','position','date','growth') -> early.growth
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
mutate(variety=as.factor(variety)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth') -> early.growth
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
mutate(variety=as.factor(variety)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth') -> early.growth
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
mutate(variety=as.factor(variety)) %>%
mutate(growth = position/date) %>%
select('variety','root','position','date','growth') -> early.growth
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety = case_when(
grepl("A", image) ~ "Amiggo",
grepl("B", image) ~ "Biggben",
grepl("H", image) ~ "Hyperion",
grepl("J", image) ~ "Juno",
grepl("S", image) ~ "Swingg",
grepl("V", image) ~ "Vegga",
TRUE ~ NA_character_ )) %>%
mutate(variety=as.factor(variety)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(variety=as.factor(variety)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth') -> early.growth
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth') -> early.growth
View(early.growth)
View(early.data)
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth') -> early.growth
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date)
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth') -> early.growth
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> early.growth
View(early.growth)
View(early.data)
early.data %>%
lm(ratio_diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
rm(early.global)
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> early.growth
early.growth %>%
ggplot(aes(x=variety,y=growth))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(x='variete',
y='growth [cm/day]',
title='Primary root grotwh ')+
theme_classic()
early.growth %>%
lm(growth ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
early.growth %>%
ggplot(aes(x=variety,y=growth))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(x='variete',
y='growth [cm/day]',
title='Primary root grotwh ')+
theme_classic()
