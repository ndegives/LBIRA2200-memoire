geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='ratio root/parent_root')+
theme_gray()
early.data %>%
lm(ratio_diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
mod <- lm(growth~diameter*variety, data=early.growth)
summary(mod)
plot(mod)
View(node)
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(diameter)
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(diameter)
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(diameter)
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
View(early.global)
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
node$variety = as.factor(node$variety)
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
subset(end.data, root_ontology==" Lateral root") %>%
diameter_outliers(.) %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='lateral root')+
theme_gray()
end.data$parent <- as.factor(end.data$parent)
for (pa in end.data$parent) {
print(pa)
}
min_dia <- aggregate(diametre ~ parent, data=end.data,FUN=min)
min_dia <- aggregate(diameter ~ parent, data=end.data,FUN=min)
View(min_dia)
View(end.data)
subset(end.data,root_ontology==' Root')
nrow(subset(end.data,root_ontology==' Root'))
View(node)
18*5
min_dia <- aggregate(diameter ~ parent, data=end.data,FUN=min) %>%
left_join(., end.data, by = "parent")
View(min_dia)
min_dia <- aggregate(diameter ~ parent, data=end.data,FUN=min)
min_dia <- aggregate(diameter ~ parent, data=end.data,FUN=min) %>%
left_join(., end.data, by = "parent")
min_dia <- aggregate(diameter ~ parent+vairety, data=end.data,FUN=min)
min_dia <- aggregate(diameter ~ parent+variety, data=end.data,FUN=min)
View(min_dia)
ggplot(data=min_dia, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='lateral root')+
theme_gray()
View(end.data)
min_dia <- aggregate(diameter ~ parent+variety+parent.name, data=end.data,FUN=min)
min_dia <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
View(min_dia)
mod <- lm(diameter ~ variety, data = min_dia)
summary(mod)
anova(mod)
Anova(mod)
min_dia <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
ggplot(data=min_dia, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
mod <- lm(diameter ~ variety, data = min_dia)
summary(mod)
anova(mod)
par(mfrow=c(2,2))
print(mod)
plot(mod)
min_dia_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(min_dia, variety==variete) %>%
diameter_outliers(.) %>%
rbin(min_dia_clean,.)
}
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(min_dia, variety==variete) %>%
diameter_outliers(.) %>%
rbind(min_dia_clean,.)
}
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(min_dia, variety==variete) %>%
diameter_outliers(.) %>%
rbind(min_dia_clean,.) -> min_dia_clean
}
View(min_dia_clean)
mod <- lm(diameter ~ variety, data = min_dia_clean)
summary(mod)
anova(mod)
par(mfrow=c(2,2))
plot(mod)
ggplot(data=min_dia, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
ggplot(data=min_dia_clean, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
t <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min) %>%
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(min_dia, variety==variete) %>%
diameter_outliers(.) %>%
rbind(min_dia_clean,.) -> min_dia_clean
}
t <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min) %>%
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(., variety==variete) %>%
diameter_outliers(.) %>%
rbind(t,.) -> t
}
min_dia <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
min_dia_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(min_dia, variety==variete) %>%
diameter_outliers(.) %>%
rbind(min_dia_clean,.) -> min_dia_clean
}
ggplot(data=min_dia_clean, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
mod <- lm(diameter ~ variety, data = min_dia_clean)
summary(mod)
anova(mod)
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
barplot(min_dia_clean$diameter)
plot(density(min_dia_clean$diameter))
density(min_dia_clean$diameter)
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
#plot(density(min_dia_clean$diameter))
ggplot(data=Dmin_clean, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
mod <- lm(diameter ~ variety, data = Dmin_clean)
summary(mod)
anova(mod)
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
View(end.data)
# Boxplot nodal
subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.) %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Anova
subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.) %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
Dmax_clean <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Boxplot nodal
Dmax_clean %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Anova
Dmax_clean %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
nodal <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Boxplot nodal
nodal %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Anova
nodal %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
View(nodal)
Dmax <- max(nodal$diameter)
View(early.growth)
View(early.global)
View(end.data)
View(early.data)
IBD <- data.frame("Plant" : c(1,2,3))
IBD <- data.frame("Plant" = c(1,2,3))
View(IBD)
View(early.data)
View(end.data)
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
node$variety = as.factor(node$variety)
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
#plot(density(min_dia_clean$diameter))
ggplot(data=Dmin_clean, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
mod <- lm(diameter ~ variety, data = Dmin_clean)
summary(mod)
anova(mod)
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
nodal <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Boxplot nodal
nodal %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Anova
nodal %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
Dmax <- max(nodal$diameter)
View(early.data)
subset(root_name=='root_0)
early.data %>%
subset(root_name=='root_0')
early.data %>%
subset(root_name=='root_0')
early.data %>%
subset(root_name==' root_0')
early.data %>%
subset(root_name==' root_0') %>%
ggplot(aes(x=variety,y=child_density))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
early.data %>%
subset(root_name==' root_0') %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density) %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
early.data %>%
subset(root_name==' root_0') %>%
lm(IBD ~ variety, data=.) -> mod
early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density) %>%
lm(IBD ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density) %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density) %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root',y='ff')+
theme_classic()
early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density) %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root',y='IBD [cm]')+
theme_classic()
early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density) %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',y='IBD [cm]')+
theme_classic()
