library(stringr)
library(pander)
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
select('root_name','diameter','root_ontology','root','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
# Fichier avec nombre par noeud
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
node$variety = as.factor(node$variety)
#PLot
ggplot(aggregate(number ~variety+node,data = node,FUN=mean),aes(x=node,y=number,color=variety)) +
geom_point(alpha = 0.5, size=3) +
geom_line()+
labs(color = "Variété",
x= "#node",
y= "# roots per node",
title = "nombre de racine par noeuds")
#Table
pander(left_join(
node %>% group_by(variety, node) %>% summarize(mean = mean(number)),
node %>% group_by(variety, node) %>% summarize(sd = sd(number))
))
View(end.data)
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
select('root_name','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
View(end.data)
mean_variety <- function(variete) {
end.data %>%
filter(variety==variete)
}
Amiggo <- mean_variety('Amiggo')
View(Amiggo)
mean_variety('Amiggo')
ggplot()+
geom_boxplot(data=end.data,aes(diameter))
ggplot(end.data,aes(x=variety,y=diameter))+
facet_wrap(~root_ontology)+
geom_boxplot()
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
select('root_name','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
# Fichier avec nombre par noeud
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
node$variety = as.factor(node$variety)
#PLot
ggplot(aggregate(number ~variety+node,data = node,FUN=mean),aes(x=node,y=number,color=variety)) +
geom_point(alpha = 0.5, size=3) +
geom_line()+
labs(color = "Variété",
x= "#node",
y= "# roots per node",
title = "nombre de racine par noeuds")
#Table
pander(left_join(
node %>% group_by(variety, node) %>% summarize(mean = mean(number)),
node %>% group_by(variety, node) %>% summarize(sd = sd(number))
))
# Boxplot nodal and lateral
ggplot(end.data,aes(x=variety,y=diameter))+
facet_wrap(~root_ontology)+
geom_boxplot()
View(end.data)
# Boxplot nodal and lateral
subset(end.data, root_ontology==" Root") %>%
ggplot(end.data,aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='root')
subset(end.data, root_ontology==" Root")
# Boxplot nodal and lateral
subset(end.data, root_ontology==" Root") %>%
ggplot(end.data,aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='root')
# Boxplot nodal and lateral
subset(end.data, root_ontology==" Root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='root')
subset(end.data, root_ontology=="Lateral root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='root')
subset(end.data, root_ontology==" Lateral root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='root')
# Boxplot nodal and lateral
subset(end.data, root_ontology==" Root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='nodal root')
subset(end.data, root_ontology==" Lateral root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='lateral root')
# Boxplot nodal and lateral
subset(end.data, root_ontology==" Root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='nodal root')+
theme_classic()
subset(end.data, root_ontology==" Lateral root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
labs(title='lateral root')+
theme_gray()
# Boxplot nodal and lateral
subset(end.data, root_ontology==" Root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun.y=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Boxplot nodal and lateral
subset(end.data, root_ontology==" Root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
subset(end.data, root_ontology==" Lateral root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='lateral root')+
theme_gray()
summary(end.data)
View(end.data)
subset(end.data, root_ontology==" Lateral root") %>%
lm( diameter ~ variety) -> mod
subset(end.data, root_ontology==" Lateral root") %>%
lm(diameter ~ variety) -> mod
subset(end.data, root_ontology==" Lateral root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
subset(end.data, root_ontology==" Lateral root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
subset(end.data, root_ontology==" Lateral root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
subset(end.data, root_ontology==" Lateral root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
res <- leveneTest(mod, center = "median")
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
res <- leveneTest(mod, center = "median")
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
res <- leveneTest(mod, center = "median")
library(car)
install.packages('car')
library(car)
pander(leveneTest(mod, center = "median"))
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
subset(end.data, root_ontology==" Lateral root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
View(end.data)
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)
end.data <- data.frame()
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety))
}
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
#  select('root_name','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
# Fichier avec nombre par noeud
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
node$variety = as.factor(node$variety)
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
select('root_name','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
# Fichier avec nombre par noeud
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
node$variety = as.factor(node$variety)
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
subset(end.data, root_ontology==" Lateral root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
# Boxplot nodal
subset(end.data, root_ontology==" Root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
subset(end.data, root_ontology==" Root") %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
pander(leveneTest(mod, center = "median"))
# Boxplot nodal
subset(end.data, root_ontology==" Root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Boxplot lateral
subset(end.data, root_ontology==" Lateral root") %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='lateral root')+
theme_gray()
print(i)
for (root in 3) {
print(i)
}
for (root in subset(end.data,root_ontology == " Root")) {
print(i)
}
for (root in subset(end.data,root_ontology == " Root")) {
print('i')
}
View(end.data)
root
print(root)
for (root in subset(end.data,root_ontology == " Root")) {
print(root)
}
for (root in subset(end.data,root_ontology == " Root")) {
print(root)
}
print(root_name)
print(root$name)
for (root in subset(end.data,root_ontology == " Root")) {
print(root$name)
}
print(root["name",root])
for (root in subset(end.data,root_ontology == " Root")) {
print(root["name",root])
}
print(root[root,"name"])
for (root in subset(end.data,root_ontology == " Root")) {
print(root[root,"name"])
}
subset(end.data,root_ontology == " Root")
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
for (root in subset(end.data,root_ontology == " Root")$root) {
print(root)
}
for (root in subset(end.data,root_ontology == "Lateral root")$root) {
print(root)
}
for (root in subset(end.data,root_ontology == " Lateral root")$root) {
print(root)
}
m_f$parent_name = subset(end.data,root=root)$parent_name
m_f <- data.frame()
for (root in subset(end.data,root_ontology == " Lateral root")$root) {
m_f$root=subset(end.data,root=root)$root_name
m_f$diameter = subset(end.data,root=root)$diameter
m_f$parent_name = subset(end.data,root=root)$parent_name
# m_f$parent_diameter = subset()
}
subset(end.data,root_ontology == " Lateral root")$root)
subset(end.data,root_ontology == " Lateral root")$root
for (root in subset(end.data,root_ontology == " Lateral root")$root) {
m_f$root=subset(end.data,root=root)$root_name
m_f$diameter = subset(end.data,root=root)$diameter
m_f$parent_name = subset(end.data,root=root)$parent_name
# m_f$parent_diameter = subset()
}
end.data %>%
mutate(parent_diameter = subset(end.data,root_name=parent_name)$diameter)
subset(end.data,root_name=A1_1_1)$diameter
df <- end.data
merged <- merge(df, subset(df, select=c('root_name', 'diameter')),
by.x='parent_name', by.y='root_name', all.x=TRUE)
# Ajout de la colonne "parent_diameter" au dataframe initial
df$parent_diameter <- merged$diameter.y
# Affichage du résultat
print(df)
end.data %>%
mutate(parent_diameter = ifelse(parent_name != '-1',
diameter[match(parent_name, root_name)], NA))
end.data <- end.data %>%
mutate(parent_diameter = ifelse(parent_name != '-1',
diameter[match(parent_name, root_name)],
NA))
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA))
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
View(end.data)
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
View(end.data)
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.)
}
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
# Fichier avec nombre par noeud
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
node$variety = as.factor(node$variety)
View(end.data)
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
end.data <- rbind(end.data,.)
}
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.)
}
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1', diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
View(end.data)
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv()
}
read.csv("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/Amiggo.csv")
end.data <- data.frame()
for (variety in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variety,".csv") %>%
read.csv() %>%
mutate(variety = factor(variety)) %>%
mutate(parent_diameter = ifelse(parent_name != '-1',
diameter[match(parent_name, root_name)], NA)) %>%
select('root_name','root','diameter','root_ontology','parent_name','variety') %>%
rbind(end.data,.) -> end.data
}
summary(end.data)
# Fichier avec nombre par noeud
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
node$variety = as.factor(node$variety)
