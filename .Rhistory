filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
renames(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
rename(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
rename(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
View(Amiggo)
View(child_diameter)
Vegga <- mean_dataset("Vegga")
View(Vegga)
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
library(lme4)
library(lmerTest)
library(archiDART)
# Chunk 2
# path <- "C:/Nico/Github/Memoire/End_growth_root_data/root_data/Amiggo"
# archidraw(inputrsml = amiggo_path,unitlength="cm", rsml.date="age", coldate=rainbow(15), lwd=2, twod=c("x", "y"), asp=1, las=1, bty="l")
# Chunk 3
all_data <- data.frame()
for (genotype in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",genotype,".csv") %>%
read.csv() %>%
mutate(variety = factor(genotype)) %>%
rbind(all_data,.) -> all_data
}
colnames(all_data)
all_data <- select(all_data,c('root_name','diameter','root_ontology','root','parent_name','variety'))
head(all_data,2)
summary(all_data)
# Chunk 4
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
rename(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
Biggben <- mean_dataset("Biggben")
Hyperion <- mean_dataset("Hyperion")
Juno <- mean_dataset("Juno")
Swingg <- mean_dataset("Swingg")
Vegga <- mean_dataset("Vegga")
View(Hyperion)
View(all_data)
all_data %>%
filter(variety=="Amiggo", root_ontology=="Lateral root")
all_data %>%
filter(variety=="Amiggo", root_ontology==" Lateral root")
all_data %>%
filter(variety=="Amiggo", root_ontology==" Lateral root") %>%
select("root_name","parent_name","diameter")
View(Amiggo)
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
library(lme4)
library(lmerTest)
# Chunk 2
data<- read_excel("Sorgho20_21_22_CIPF.xlsx")
data<- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
head(data)
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
library(lme4)
library(lmerTest)
# Chunk 2
data<- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
head(data)
# Chunk 3
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis','type_sorgho')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
data$annee <- as.factor(data$annee)
pander(summary(data))
# Chunk 4
meteo <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
library(lme4)
library(lmerTest)
# Chunk 2
data<- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
head(data)
# Chunk 3
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis','type_sorgho')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
data$annee <- as.factor(data$annee)
pander(summary(data))
# Chunk 4
meteo <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
mean_culture_rain <- c(
mean((subset(meteo,annee==2020)$mean_rain)),
mean((subset(meteo,annee==2021)$mean_rain)),
mean((subset(meteo,annee==2022)$mean_rain))
)
mean_culture_rain <- data.frame(c(2020,2021,2022),mean_culture_rain)
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")
#Plot temperature
ggplot(data = meteo, aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_temp),width=0.5,fill='red')+
labs(title='Temperature')
#Diagramme ombrothermique
Mois = c('06/20','07/20','08/20','09/20','10/20',
'06/21','07/21','08/21','09/21','10/21',
'06/22','07/22','08/22','09/22')
plot.new()
par(mar=c(4,4,3,4))
position=barplot(meteo$mean_rain,col='blue',names.arg = Mois,axes=F,ylab="",xlab="",main="Precipitation et température",ylim=c(0,200))
data<- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
head(data)
View(data)
View(mean_culture_rain)
mean_culture_rain <- data.frame(a=c(2020,2021,2022),mean_culture_rain)
View(mean_culture_rain)
rm(mean_culture_rain)
meteo <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
mean_culture_rain <- c(
mean((subset(meteo,annee==2020)$mean_rain)),
mean((subset(meteo,annee==2021)$mean_rain)),
mean((subset(meteo,annee==2022)$mean_rain))
)
mean_culture_rain <- data.frame(Year=c(2020,2021,2022),mean_culture_rain)
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")
#Plot temperature
ggplot(data = meteo, aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_temp),width=0.5,fill='red')+
labs(title='Temperature')
#Diagramme ombrothermique
Mois = c('06/20','07/20','08/20','09/20','10/20',
'06/21','07/21','08/21','09/21','10/21',
'06/22','07/22','08/22','09/22')
plot.new()
par(mar=c(4,4,3,4))
position=barplot(meteo$mean_rain,col='blue',names.arg = Mois,axes=F,ylab="",xlab="",main="Precipitation et température",ylim=c(0,200))
View(mean_culture_rain)
#Plot temperature
ggplot(data = meteo, aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_temp),width=0.5,fill='red')+
labs(title='Temperature')
plot.new()
par(mar=c(4,4,3,4))
position=barplot(meteo$mean_rain,col='blue',names.arg = Mois,axes=F,ylab="",xlab="",main="Precipitation et température",ylim=c(0,200))
axis(2,col="black",at=seq(0, 200, by=50))
par(new=TRUE,mar=c(4,4,3,4))
maximal = max(position)+(position[2]-position[1])
position=barplot(meteo$mean_rain,col='blue',names.arg = Mois,axes=F,ylab="",xlab="",main="Precipitation et température",ylim=c(0,200))
View(meteo)
data<- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
head(data)
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis','type_sorgho')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
data$annee <- as.factor(data$annee)
pander(summary(data))
meteo <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
mean_culture_rain <- c(
mean((subset(meteo,annee==2020)$mean_rain)),
mean((subset(meteo,annee==2021)$mean_rain)),
mean((subset(meteo,annee==2022)$mean_rain))
)
mean_culture_rain <- data.frame(Year=c(2020,2021,2022),mean_culture_rain)
View(mean_culture_rain)
View(meteo)
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
library(lme4)
library(lmerTest)
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
library(lme4)
library(lmerTest)
data<- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
head(data)
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis','type_sorgho')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
data$annee <- as.factor(data$annee)
pander(summary(data))
meteo <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
mean_culture_rain <- c(
mean((subset(meteo,annee==2020)$mean_rain)),
mean((subset(meteo,annee==2021)$mean_rain)),
mean((subset(meteo,annee==2022)$mean_rain))
)
mean_culture_rain <- data.frame(Year=c(2020,2021,2022),mean_culture_rain)
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")
#Plot temperature
ggplot(data = meteo, aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_temp),width=0.5,fill='red')+
labs(title='Temperature')
#Diagramme ombrothermique
Mois = c('06/20','07/20','08/20','09/20','10/20',
'06/21','07/21','08/21','09/21','10/21',
'06/22','07/22','08/22','09/22')
plot.new()
par(mar=c(4,4,3,4))
position=barplot(meteo$mean_rain,col='blue',names.arg = Mois,axes=F,ylab="",xlab="",main="Precipitation et température",ylim=c(0,200))
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
data<- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
head(data)
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis','type_sorgho')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
data$annee <- as.factor(data$annee)
pander(summary(data))
meteo <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
mean_culture_rain <- c(
mean((subset(meteo,annee==2020)$mean_rain)),
mean((subset(meteo,annee==2021)$mean_rain)),
mean((subset(meteo,annee==2022)$mean_rain))
)
mean_culture_rain <- data.frame(Year=c(2020,2021,2022),mean_culture_rain)
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Plot temperature
ggplot(data = meteo, aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_temp),width=0.5,fill='red')+
labs(title='Temperature')
#Diagramme ombrothermique
Mois = c('06/20','07/20','08/20','09/20','10/20',
'06/21','07/21','08/21','09/21','10/21',
'05/22','06/22','07/22','08/22','09/22')
plot.new()
par(mar=c(4,4,3,4))
position=barplot(meteo$mean_rain,col='blue',names.arg = Mois,axes=F,ylab="",xlab="",main="Precipitation et température",ylim=c(0,200))
axis(2,col="black",at=seq(0, 200, by=50))
par(new=TRUE,mar=c(4,4,3,4))
maximal = max(position)+(position[2]-position[1])
plot(position,meteo$mean_temp,col="red",type="o",lwd=2,pch=16,axes=F,ylab="",xlab="",ylim=c(0,25))
axis(4,col.axis='red',col='red')
box();grid()
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),fill='blue')+
labs(title = "Pluviometrie")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#Plot temperature
ggplot(data = meteo, aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_temp),width=0.5,fill='red')+
labs(title='Temperature')
#Plot precipitation
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),width=0.5,fill='blue')+
labs(title = "Pluviometrie")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# Plot général
ggplot(data=subset(data,annee==2021),aes(x=`%MS`,y=rendement_MS, color=variete)) + geom_point(alpha = 1, size=3) +
labs(color = "Variety",
x= "% Dry matter",
y= "Dry matter yield [t/ha]",
title="Yield")
# Plot général
ggplot(data,aes(x=annee,y=rendement_MS, color=variete)) + geom_point(alpha = 0.8, size=3) +
labs(color = "Variety",
x= "Year",
y= "Dry matter yield [t/ha]",
title="Yield by year and variety")
# Barplot séparé par année
ggplot(data=data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity',aes(fill=variete))+
facet_wrap(~annee)+
theme(axis.text.x=element_blank())+
labs(x='',
y='rendement [T/ha]',
title='Barplot séparé par année')
# Barplot séparé par variété
ggplot(data=data,aes(x=as.factor(annee),y=rendement_MS))+
geom_bar(stat='identity')+
facet_wrap(~variete)+
labs(x='annee',
y='rendement',
title = 'Barplot séparé par variété')
# Plot général
ggplot(data,aes(x=annee,y=rendement_MS, color=variete)) + geom_point(alpha = 0.8, size=3) +
labs(color = "Variety",
x= "Year",
y= "Dry matter yield [t/ha]",
title="Yield by year and variety")
# Barplot séparé par année
ggplot(data=data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity',aes(fill=variete))+
facet_wrap(~annee)+
theme(axis.text.x=element_blank())+
labs(x='',
y='rendement [T/ha]',
title='Barplot séparé par année')
# Barplot séparé par variété
ggplot(data=data,aes(x=as.factor(annee),y=rendement_MS))+
geom_bar(stat='identity')+
facet_wrap(~variete)+
labs(x='annee',
y='rendement',
title = 'Barplot séparé par variété')
# Box plot
ggplot(data=data,aes(x=annee,y=rendement_MS))+
geom_boxplot()+
labs(x='Variété',
y='rendement [T/ha]')
# Test
mod <- lm(data=data, rendement_MS~annee)
summary(mod)
anova(mod)
# Box plot
ggplot(data=data,aes(x=annee,y=rendement_MS))+
geom_boxplot()+
labs(x='Année',
y='rendement [T/ha]')
# Test
mod <- lm(data=data, rendement_MS~annee)
summary(mod)
anova(mod)
# Box plot
ggplot(data=data,aes(x=variete,y=rendement_MS))+
geom_boxplot()+
labs(x='Variété',
y='rendement [T/ha]')
# Test
mod <- lm(data=data, rendement_MS~variete)
summary(mod)
anova(mod)
# Test
mod <- lm(data=data, rendement_MS~annee+variete)
summary(mod)
anova(mod)
# Test
mod <- lm(data=data, rendement_MS~annee+variete)
summary(mod)
anova(mod)
mod <- lmer(data=data,formula = rendement_MS~variete+(1|annee))
summary(mod)
anova(mod)
ranova(mod)
mod <- lmer(data=data,formula = rendement_MS~variete+(1|annee))
summary(mod)
anova(mod)
ranova(mod)
GRooTFullVersion <- read.csv("C:/Users/nicd/Downloads/GRooTFullVersion.csv")
View(GRooTFullVersion)
a <- subset(GRooTFullVersion, genus=='Sorghum')
View(a)
colnames(a)
GRooTAggregateSpeciesVersion <- read.csv("C:/Users/nicd/Downloads/GRooTAggregateSpeciesVersion.csv")
View(GRooTAggregateSpeciesVersion)
b = subset(GRooTAggregateSpeciesVersion,genusTNRS='Sorghum')
View(b)
b = subset(GRooTAggregateSpeciesVersion,genusTNRS=='Sorghum')
View(b)
FRED3_Entire_Database_2021 <- read.csv("C:/Users/nicd/Downloads/FRED3_Entire_Database_2021.csv", header=FALSE)
View(FRED3_Entire_Database_2021)
View(a)
c <- subset(FRED3_Entire_Database_2021, V13=='Poaceae')
View(c)
te <- subset(c, V18=='Sorghum')
View(te)
library(readxl)
Sorgho20_21_22_CIPF <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx",
sheet = "Resultats")
View(Sorgho20_21_22_CIPF)
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
View(aerial)
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
View(early.global)
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
View(early.growth)
Amiggo <- read.csv("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/Amiggo.csv")
View(Amiggo)
all_data <- data.frame()
for (genotype in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",genotype,".csv") %>%
read.csv() %>%
mutate(variety = factor(genotype)) %>%
rbind(all_data,.) -> all_data
}
library(dplyr)
all_data <- data.frame()
for (genotype in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",genotype,".csv") %>%
read.csv() %>%
mutate(variety = factor(genotype)) %>%
rbind(all_data,.) -> all_data
}
colnames(all_data)
all_data <- select(all_data,c('root_name','diameter','root_ontology','root','parent_name','variety'))
head(all_data,2)
summary(all_data)
View(all_data)
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
rename(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
Biggben <- mean_dataset("Biggben")
Hyperion <- mean_dataset("Hyperion")
Juno <- mean_dataset("Juno")
Swingg <- mean_dataset("Swingg")
Vegga <- mean_dataset("Vegga")
View(Amiggo)
