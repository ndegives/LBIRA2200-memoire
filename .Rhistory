rep(mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter),5),
mod_min[["coefficients"]][["(Intercept)"]]+mod_min[["coefficients"]][["varietyVegga"]]),
Dmax=Dmax
) %>%
mutate(Drange=2*(Dmax-Dmin)/(Dmax+Dmin))
pander(Drange)
aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
View(end.data)
Dmin <- aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min)
aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min)
Drange <- aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min) %>%
mutate(Drange=2*(parent_diameter-diameter)/(parent_diameter+diameter))
Drange
Drange <- aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min) %>%
mutate(Drange=2*(parent_diameter-diameter)/(parent_diameter+diameter))
Drange_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Drange, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Drange_clean,.) -> Drange_clean
}
Drange_clean %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
Drange_clean %>%
ggplot(aes(x=variety,y=Drange))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_classic()
mod_range <- lm(Drange ~ variety, data=Drange_clean)
summary(mod_range)
pander(anova(mod_range))
par(mfrow = c(2,2))
plot(mod_range)
par(mfrow = c(1,1))
pander(leveneTest(mod_range, center = "median"))
lsm <- lsmeans(mod_range, pairwise ~ variety)
summary(lsm)
plot(lsm)
paste('La moyenne de toute les vaiétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter))
Drange <- aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min) %>%
mutate(Drange=2*(parent_diameter-diameter)/(parent_diameter+diameter))
Drange_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Drange, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Drange_clean,.) -> Drange_clean
}
Drange_clean %>%
ggplot(aes(x=variety,y=Drange))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_classic()
mod_range <- lm(Drange ~ variety, data=Drange_clean)
summary(mod_range)
pander(anova(mod_range))
mod_range <- lm(Drange ~ variety, data=Drange_clean)
summary(mod_range)
pander(anova(mod_range))
par(mfrow = c(2,2))
plot(mod_range)
par(mfrow = c(1,1))
pander(leveneTest(mod_range, center = "median"))
lsm <- lsmeans(mod_range, pairwise ~ variety)
summary(lsm)
plot(lsm)
View(Drange_clean)
paste('La moyenne de toute les vaiétés sauf Juno =',
mean(subset(Drange_clean,!(variety=='Juno'))$Drange))
lsm <- lsmeans(mod_range, pairwise ~ variety)
summary(lsm)
plot(lsm)
paste('La moyenne de toute les vaiétés sauf Juno =',
mean(subset(Drange_clean,!(variety=='Juno'))$Drange))
branching %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',y='IBD [cm]')+
theme_classic()
branching <- early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
branching %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',y='IBD [cm]')+
theme_classic()
mod_IBD <- lm(IBD ~ variety, data=branching)
summary(mod_IBD)
pander(anova(mod_IBD))
branching <- early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
branching %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',y='IBD [cm]')+
theme_classic()
mod_IBD <- lm(IBD ~ variety, data=branching)
summary(mod_IBD)
pander(anova(mod_IBD))
par(mfrow = c(2,2))
plot(mod_IBD)
par(mfrow = c(1,1))
pander(leveneTest(mod_IBD, center = "median"))
lsm <- lsmeans(mod_IBD, pairwise ~ variety)
summary(lsm)
plot(lsm)
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_boxplot()
end.data.clean %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
end.data.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
end.data.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")
+
scale_y_continuous(limits = c(0,0.075))
end.data.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data.clean)
summary(mod_DIDm)
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data.clean)
summary(mod_DIDm)
anova(mod_DIDm)
end.data.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
end.data.clean <- end.data %>%
diameter_outliers()
end.data.clean <- end.data %>%
diameter_outliers()
end.data.clean <- end.data %>%
diameter_outliers()
end.data.clean <- end.data %>%
diameter_outliers()
end.data.clean <- end.data %>%
diameter_outliers()
end.data.clean <- end.data %>%
diameter_outliers()
end.data.clean <- end.data %>%
diameter_outliers()
end.data.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data.clean)
summary(mod_DIDm)
anova(mod_DIDm)
summary(lm(diameter~variety, data=end.data.clean))
nodal_clean %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
end.data.clean %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
View(end.data.clean)
end.data %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
end.data %>% summary(lm(diameter~variety))
View(end.data)
end.data %>% summary(lm(diameter~variety))
end.data.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
end.data %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data)
summary(mod_DIDm)
anova(mod_DIDm)
View(end.global)
View(early.data)
end.data.clean <- subset(end.data,root_ontology==' Lateral root') %>%
diameter_outliers()
end.data.clean <- subset(end.data,root_ontology==' Lateral root') %>%
diameter_outliers()
### Stats descriptive
```{r, echo=TRUE}
end.data %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
end.data %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
### Modèle
```{r, echo=TRUE}
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data)
summary(mod_DIDm)
anova(mod_DIDm)
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data)
summary(mod_DIDm)
anova(mod_DIDm)
end.data.clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(end.data, variety==variete) %>%
diameter_outliers(.) %>%
rbind(end.data.clean,.) -> end.data.clean
}
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data.clean)
summary(mod_DIDm)
anova(mod_DIDm)
View(nodal_clean)
View(end.data.clean)
end.data.clean <- subset(end.data,root_ontology==' Lateral root') %>%
diameter_outliers()
end.data.clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(end.data, variety==variete) %>%
diameter_outliers(.) %>%
rbind(end.data.clean,.) -> end.data.clean
}
View(end.data.clean)
end.data.clean <- subset(end.data,root_ontology==' Lateral root') %>%
diameter_outliers()
filter(end.data, variety==variete,root_ontology==' Lateral root') %>%
diameter_outliers(.) %>%
rbind(end.data.clean,.) -> end.data.clean
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
filter(end.data, variety==variete,root_ontology==' Lateral root') %>%
diameter_outliers(.) %>%
rbind(end.data.clean,.) -> end.data.clean
}
end.data.clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
filter(end.data, variety==variete,root_ontology==' Lateral root') %>%
diameter_outliers(.) %>%
rbind(end.data.clean,.) -> end.data.clean
}
View(end.data.clean)
end.data.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data.clean)
summary(mod_DIDm)
anova(mod_DIDm)
summary(end.data.clean)
mod_DIDm <- lm(diameter~variety,data=end.data.clean)
summary(mod_DIDm)
anova(mod_DIDm)
*parent_diameter
*parent_diameter
mod_DIDm <- lm(diameter~variety*parent_diameter,data=end.data.clean)
summary(mod_DIDm)
anova(mod_DIDm)
end.data.clean %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_classic()
mod_DIDm <- lm(diameter~variety,data=end.data.clean)
summary(mod_DIDm)
anova(mod_DIDm)
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
library(lsmeans)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
# Chunk 9
ggplot(data=Dmin_clean, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Diamètre minimum de lateral pour chaque nodale')+
theme_gray()
# Chunk 10
mod_min <- lm(diameter ~ variety, data = Dmin_clean)
summary(mod_min)
anova(mod_min)
# Chunk 11
par(mfrow=c(2,2))
plot(mod_min)
par(mfrow=c(1,1))
pander(leveneTest(mod_min, center = "median"))
# Chunk 12
lsm <- lsmeans(mod_min, pairwise ~ variety)
summary(lsm)
plot(lsm)
paste('La moyenne de toute les variétés sauf Vegga =',
mean(subset(Dmin_clean,!(variety=='Vegga'))$diameter))
# Chunk 13
nodal_clean <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Chunk 14
nodal_clean %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Chunk 15
mod_max <- lm(diameter ~ variety, data=nodal_clean)
summary(mod_max)
pander(anova(mod_max))
# Chunk 16
par(mfrow = c(2,2))
plot(mod_max)
par(mfrow = c(1,1))
pander(leveneTest(mod_max, center = "median"))
# Chunk 17
Dmax <- max(nodal_clean$diameter)
paste('Le Dmax global pour les six variétés est',Dmax)
# Chunk 18
Drange <- aggregate(diameter ~ parent+variety+parent_name+parent_diameter, data=end.data,FUN=min) %>%
mutate(Drange=2*(parent_diameter-diameter)/(parent_diameter+diameter))
Drange_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Drange, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Drange_clean,.) -> Drange_clean
}
# Chunk 19
Drange_clean %>%
ggplot(aes(x=variety,y=Drange))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Drange')+
theme_classic()
# Chunk 20
mod_range <- lm(Drange ~ variety, data=Drange_clean)
summary(mod_range)
pander(anova(mod_range))
# Chunk 21
par(mfrow = c(2,2))
plot(mod_range)
par(mfrow = c(1,1))
pander(leveneTest(mod_range, center = "median"))
# Chunk 22
lsm <- lsmeans(mod_range, pairwise ~ variety)
summary(lsm)
plot(lsm)
paste('La moyenne de toute les variétés sauf Juno =',
mean(subset(Drange_clean,!(variety=='Juno'))$Drange))
# Chunk 23
branching <- early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
# Chunk 24
branching %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',y='IBD [cm]')+
theme_classic()
# Chunk 25
mod_IBD <- lm(IBD ~ variety, data=branching)
summary(mod_IBD)
pander(anova(mod_IBD))
# Chunk 26
par(mfrow = c(2,2))
plot(mod_IBD)
par(mfrow = c(1,1))
pander(leveneTest(mod_IBD, center = "median"))
# Chunk 27
lsm <- lsmeans(mod_IBD, pairwise ~ variety)
summary(lsm)
plot(lsm)
# Chunk 28
lateral.clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
filter(end.data, variety==variete,root_ontology==' Lateral root') %>%
diameter_outliers(.) %>%
rbind(lateral.clean,.) -> lateral.clean
}
# Chunk 29
lateral.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
# Chunk 30
mod_DIDm <- lm(diameter~variety*parent_diameter,data=lateral.clean)
summary(mod_DIDm)
anova(mod_DIDm)
par(mfrow=c(2,2))
plot(mod_DIDm)
par(mfrow=c(1,1))
pander(leveneTest(mod_DIDm, center = "median"))
lateral.clean %>%
ggplot(aes(x=parent_diameter,y=diameter,col=variety))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
summary(lm(diameter~variety*parent_diameter,data=subset(lateral.clean,variety=='Amiggo')))
summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Amiggo')))
summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Vegga')))
summary(mod_DIDm)
summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Vegga')))
summary(mod_DIDm)
summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Amiggo')))
summary(lm(diameter~parent_diameter,data=subset(lateral.clean,variety=='Biggben')))
early.data %>%
ggplot(aes(x=variety,y=ratio_diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='ratio root/parent_root')+
theme_gray()
15*15+15*15
sqrt(450)
sqrt(15^2+15^2)
20^2
21.21^2
