geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))+
stat_regline_equation(
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
label.x = "right",
label.y = "top")
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))+
stat_regline_equation(
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
label.x = "right",
label.y = "top")
update.packages()
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
#plot(density(min_dia_clean$diameter))
ggplot(data=Dmin_clean, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
mod <- lm(diameter ~ variety, data = Dmin_clean)
summary(mod)
anova(mod)
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
# Chunk 9
nodal <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Boxplot nodal
nodal %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Anova
nodal %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
# Chunk 10
Dmax <- max(nodal$diameter)
# Chunk 11
# Chunk 12
branching <- early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
branching %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',y='IBD [cm]')+
theme_classic()
branching %>%
lm(IBD ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))+
stat_regline_equation(
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
label.x = "right",
label.y = "top")
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
#plot(density(min_dia_clean$diameter))
ggplot(data=Dmin_clean, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
mod <- lm(diameter ~ variety, data = Dmin_clean)
summary(mod)
anova(mod)
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
# Chunk 9
nodal <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Boxplot nodal
nodal %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Anova
nodal %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
# Chunk 10
Dmax <- max(nodal$diameter)
# Chunk 11
# Chunk 12
branching <- early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
branching %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',y='IBD [cm]')+
theme_classic()
branching %>%
lm(IBD ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))+
stat_regline_equation(
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
label.x = "right",
label.y = "top")
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))+
stat_regline_equation(
aes(label = paste(after_stat(eq.label), ..rr.label.., sep = "~~~")),
label.x = "right",
label.y = "top")
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
# Load your packages here
library(dplyr)
library(readxl)
library(ggplot2)
library(stringr)
library(pander)
library(car)
library(archiDART)
library(ggpubr)
# Chunk 2
diameter_outliers <- function(data) {
Q1 <- quantile(data$diameter, 0.25)
Q3 <- quantile(data$diameter, 0.75)
IQR <- Q3 - Q1
lower <- Q1 - 1.5*IQR
upper <- Q3 + 1.5*IQR
data_clean <- data %>% filter(diameter >= lower & diameter <= upper)
return(data_clean)
}
# Chunk 3
# Load your data here
aerial <- read_excel("Aerials data/Sorgho20_21_22_CIPF.xlsx")
early.global <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early global.csv")
early.growth <- read.csv("C:/Nico/Github/Memoire/Early_growth_root_data/early growth.csv")
node <- read_excel("End_growth_root_data/root_data/0.global_root_data/node.xlsx")
end.global <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",variete,".csv") %>%
read.csv() %>%
mutate(variety = factor(variete)) %>%
rbind(end.global,.) -> end.global
}
# Chunk 4
early.data <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
early.global %>%
subset(grepl(substr(variete, start = 1, stop = 1),.$image)) %>%
mutate(variety=factor(variete)) %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) %>%
rbind(early.data,.) -> early.data
}
# Chunk 5
early.growth %>%
subset(root_name==' root_0') %>%
group_by(root) %>%
na.omit() %>%
filter(date == max(date)) %>%
mutate(growth = position/date) %>%
left_join(., early.data, by = "root") %>%
select('variety','root','position','date','growth','diameter') -> primary
# Chunk 6
node$variety = as.factor(node$variety)
# Chunk 7
end.global %>%
select('root_name','root','diameter','root_ontology','parent','parent_name','variety','child_density') %>%
mutate(parent_diameter = ifelse(parent != '-1', diameter[match(parent, root)],NA)) %>%
mutate(ratio_diameter = ifelse(parent_name != '-1', diameter/parent_diameter, NA)) -> end.data
# Chunk 8
Dmin <- aggregate(diameter ~ parent+variety+parent_name, data=end.data,FUN=min)
Dmin_clean <- data.frame()
for (variete in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
subset(Dmin, variety==variete) %>%
diameter_outliers(.) %>%
rbind(Dmin_clean,.) -> Dmin_clean
}
#plot(density(min_dia_clean$diameter))
ggplot(data=Dmin_clean, aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='Plus petite latérale de chaque racine nodale')+
theme_gray()
mod <- lm(diameter ~ variety, data = Dmin_clean)
summary(mod)
anova(mod)
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
# Chunk 9
nodal <- subset(end.data, root_ontology==" Root") %>%
diameter_outliers(.)
# Boxplot nodal
nodal %>%
ggplot(aes(x=variety,y=diameter))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='nodal root')+
theme_classic()
# Anova
nodal %>%
lm(diameter ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
# Chunk 10
Dmax <- max(nodal$diameter)
# Chunk 11
# Chunk 12
branching <- early.data %>%
subset(root_name==' root_0') %>%
mutate(IBD=1/child_density)
branching %>%
ggplot(aes(x=variety,y=IBD))+
geom_boxplot()+
stat_summary(fun=mean, geom="point", shape=23, size=4)+
labs(title='IBD',y='IBD [cm]')+
theme_classic()
branching %>%
lm(IBD ~ variety, data=.) -> mod
summary(mod)
pander(anova(mod))
par(mfrow = c(2,2))
plot(mod)
par(mfrow = c(1,1))
pander(leveneTest(mod, center = "median"))
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))+
stat_regline_equation(
aes(label = paste(after_stat(eq.label), ..rr.label.., sep = "~~~")),
label.x = "right",
label.y = "top")
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))+
stat_regline_equation(
aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = "~~~")),
label.x = "right",
label.y = "top")
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
end.data %>%
diameter_outliers() %>%
lm(diameter~parent_diameter)%>%
summary()
summary(mod)
end.data %>%
diameter_outliers() %>%
lm(diameter~parent_diameter) -> mod
end.data %>%
diameter_outliers() %>%
lm(diameter~parent_diameter,data=.) -> mod
summary(mod)
pander(summary(mod))
plot(mod)
pander(summary(mod))
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))+
stat_regline_equation(
aes(label = paste(after_stat(eq.label), after_stat(rr.label), sep = "~~~")),
label.x = "right",
label.y = "top")
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
end.data %>%
lm(diameter~parent_diameter,data=.) -> mod
pander(summary(mod))
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
end.data %>%
diameter_outliers() %>%
lm(diameter~parent_diameter,data=.) -> mod
pander(summary(mod))
par(mfrow=c(2,2))
plot(mod)
par(mfrow=c(1,1))
end.data %>%
diameter_outliers() %>%
lm(diameter~parent_diameter,data=.) -> mod
pander(summary(mod))
summary(mod)
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_boxplot()
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter,group=variety))+
geom_boxplot()
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_boxplot()
end.data %>%
diameter_outliers() %>%
ggplot(aes(x=parent_diameter,y=diameter))+
geom_point(size=0.8)+
geom_smooth(method = "lm")+
scale_y_continuous(limits = c(0,0.075))
