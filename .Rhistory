left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1")) %>%
rename(mean_child_diameter = 'x[,"mean"]', sd_child_diameter = 'x[,"sd"]') -> data
return(data)
}
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1")) %>%
rename(mean_child_diameter = 'x[,"mean"]', sd_child_diameter = 'x[,"sd"]') -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
Biggben <- mean_dataset("Biggben")
Hyperion <- mean_dataset("Hyperion")
Juno <- mean_dataset("Juno")
Swingg <- mean_dataset("Swingg")
Vegga <- mean_dataset("Vegga")
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
library(lme4)
library(lmerTest)
library(archiDART)
all_data <- data.frame()
for (genotype in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",genotype,".csv") %>%
read.csv() %>%
mutate(variety = factor(genotype)) %>%
rbind(all_data,.) -> all_data
}
colnames(all_data)
all_data <- select(all_data,c('root_name','diameter','root_ontology','root','parent_name','variety'))
head(all_data,2)
summary(all_data)
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1")) -> data
return(data)
}
all_data <- data.frame()
for (genotype in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",genotype,".csv") %>%
read.csv() %>%
mutate(variety = factor(genotype)) %>%
rbind(all_data,.) -> all_data
}
colnames(all_data)
all_data <- select(all_data,c('root_name','diameter','root_ontology','root','parent_name','variety'))
head(all_data,2)
summary(all_data)
Amiggo <- mean_dataset("Amiggo")
Biggben <- mean_dataset("Biggben")
Hyperion <- mean_dataset("Hyperion")
Juno <- mean_dataset("Juno")
Swingg <- mean_dataset("Swingg")
Vegga <- mean_dataset("Vegga")
View(Hyperion)
Hyperion$x
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1")) %>%
mutate(mean=map(x, function(x) x$mean)) %>%
mutate(sd = map(x, function(x) x$sd)) %>%
subset(., select= -x) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
View(Amiggo)
Amiggo$x
Amiggo$x$sd
Amiggo$x$sd[sd]
Amiggo$x$[sd]
Amiggo$x[sd]
Amiggo$x['sd']
Amiggo$x
Amiggo$x[1,]
Amiggo$x[,1]
all_data %>%
filter(variety=='Amiggo', root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1"))
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1")) %>%
mutate(mean=map(x, function(x) x[,1])) %>%
mutate(sd = map(x, function(x) x[,2])) %>%
subset(., select= -x) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
Biggben <- mean_dataset("Biggben")
Hyperion <- mean_dataset("Hyperion")
Juno <- mean_dataset("Juno")
Swingg <- mean_dataset("Swingg")
Vegga <- mean_dataset("Vegga")
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1")) %>%
mutate(mean=map(x, function(x) x$mean[1])) %>%
mutate(sd = map(x, function(x) x$sd[1])) %>%
subset(., select= -x) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1")) %>%
mutate(mean=map(x, function(x) x[1][1])) %>%
mutate(sd = map(x, function(x) x[2][1])) %>%
subset(., select= -x) -> data
return(data)
}
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(.,
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))),
by = c("root_name" = "Group.1")) %>%
mutate(mean=map(x, function(x) x[1][1])) %>%
mutate(sd = map(x, function(x) x[2][1])) %>%
subset(., select= -x) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
View(child_diameter)
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) %>%
mutate(mean=map(x, function(x) x[1][1])) %>%
mutate(sd = map(x, function(x) x[2][1])) %>%
subset(., select= -x) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) -> data
return(data)
}
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
View(Amiggo)
ee
View(Hyperion)
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) %>%
rename(mean = x[,"mean"])
-> data
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) %>%
rename(mean = x[,"mean"]) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
View(child_diameter)
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter$x.mean, by = c("root_name" = "Group.1")) %>%
rename(mean = x[,"mean"]) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
data.frame(group = .$Group.1, mean = .$x.mean, sd = .$x.sd) -> child_diameter
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
View(child_diameter)
child_diameter$x
child_diameter$x[,1]
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
data.frame(group = .$Group.1, mean = .$x[,1], sd = .$x[,2]) -> child_diameter
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) %>%
rename(mean = x[,"mean"]) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
data.frame(group = .$Group.1, mean = .$x[,1], sd = .$x[,2]) -> child_diameter
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
data.frame(group = .$Group.1, mean = .$x[,1], sd = .$x[,2]) -> child_diameter
View(child_diameter)
rm(child_diameter)
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
data.frame(group = .$Group.1, mean = .$x[,1], sd = .$x[,2]) -> child_diameter
View(child_diameter)
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
data.frame(group = .$Group.1, mean = .$x[,1], sd = .$x[,2])
c <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
View(c)
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(x) x$mean[1]))
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(x) x[1]))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) %>%
rename(mean = x[,"mean"]) -> data
return(data)
}
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(x) x[1]))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) %>%
rename(mean = x[,"mean"]) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(x) x[1]))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., child_diameter, by = c("root_name" = "Group.1")) %>%
rename(mean = x[,"mean"]) -> data
return(data)
}
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(x) x[1]))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(x) x[,1]))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(x) x$x[1]))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(a) a$x[1]))
child_diameter <- aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x)))
View(child_diameter)
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(a) a[1]))
aggregate(all_data$diameter,
by=list(all_data$parent_name),
FUN=function(x) list(mean = mean(x), sd = sd(x))) %>%
mutate(mean = map(x, function(a) a[,"mean"]))
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
rename(mean = x[,"mean"]) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) -> data
return(data)
}
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) -> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
View(Amiggo)
View(child_diameter)
View(Amiggo)
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
renames(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
rename(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
rename(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
View(Amiggo)
View(child_diameter)
Vegga <- mean_dataset("Vegga")
View(Vegga)
# Chunk 1: setup
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
library(lme4)
library(lmerTest)
library(archiDART)
# Chunk 2
# path <- "C:/Nico/Github/Memoire/End_growth_root_data/root_data/Amiggo"
# archidraw(inputrsml = amiggo_path,unitlength="cm", rsml.date="age", coldate=rainbow(15), lwd=2, twod=c("x", "y"), asp=1, las=1, bty="l")
# Chunk 3
all_data <- data.frame()
for (genotype in c("Amiggo","Biggben","Hyperion","Juno","Swingg","Vegga")) {
paste0("C:/Nico/Github/Memoire/End_growth_root_data/root_data/0.global_root_data/",genotype,".csv") %>%
read.csv() %>%
mutate(variety = factor(genotype)) %>%
rbind(all_data,.) -> all_data
}
colnames(all_data)
all_data <- select(all_data,c('root_name','diameter','root_ontology','root','parent_name','variety'))
head(all_data,2)
summary(all_data)
# Chunk 4
mean_dataset <- function(variete) {
stopifnot(is.character(variete))
all_data %>%
filter(variety==variete, root_ontology==" Root") %>%
select('root_name','diameter') %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=mean), by = c("root_name" = "Group.1")) %>%
left_join(., aggregate(all_data$diameter,by=list(all_data$parent_name),FUN=sd), by = c("root_name" = "Group.1")) %>%
rename(child_mean_diameter = x.x , child_sd_diameter = x.y)-> data
return(data)
}
Amiggo <- mean_dataset("Amiggo")
Biggben <- mean_dataset("Biggben")
Hyperion <- mean_dataset("Hyperion")
Juno <- mean_dataset("Juno")
Swingg <- mean_dataset("Swingg")
Vegga <- mean_dataset("Vegga")
View(Hyperion)
View(all_data)
all_data %>%
filter(variety=="Amiggo", root_ontology=="Lateral root")
all_data %>%
filter(variety=="Amiggo", root_ontology==" Lateral root")
all_data %>%
filter(variety=="Amiggo", root_ontology==" Lateral root") %>%
select("root_name","parent_name","diameter")
View(Amiggo)
