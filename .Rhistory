ggplot(data=data)+
geom_bar(aes(x=variete,y=rendement_MS))
ggplot(data=data)+
geom_bar(aes(variete))
table(data$variete)
ggplot(data=data)+
geom_boxplot(aes(x=variete,y=rendement_MS))
ggplot(data=data)+
geom_boxplot(aes(x=variete))
library(tidyverse)
ggplot(data=data, aes(x=variete,y=rendement_MS))+
geom_boxplot()
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','annee','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
data<- read_excel("Sorgho20_21_22_CIPF.xlsx")
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','annee','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
ggplot(data=data, aes(x=variete,y=rendement_MS))+
geom_boxplot()
ggplot(data=data, aes(x=variete,y=rendement_MS))+
geom_bar()
ggplot(data=data, aes(x=variete,y=mean(rendement_MS)))+
geom_bar()
mean(rendement_MS)
ggplot(data=data, aes(x=variete,y=mean(data$rendement_MS)))+
geom_bar()
ggplot(data=data, aes(x=variete,y=rendement_MS))+
geom_bar()
data_var <- data
a2020 <- subset(data,annee==2020)
View(data)
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
a2020 <- subset(data,annee==2020)
data<- read_excel("Sorgho20_21_22_CIPF.xlsx")
head(data)
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
a2020 <- subset(data,annee==2020)
View(a2020)
a20 <- subset(data,annee==2020)
a21 <- subset(data, annee==2021)
a22 <- subset(data, annee==2022)
plot(a20$pluviométrie)
plot(a20$rendement_MS)
barplot(a20$rendement_MS)
i %in% c(a20,a21,a22) :
print(i)
for (i in c(a20,a21,a22)) {
ggplot(data = i, aes(x=variete, y=rendement_MS))+
geom_bar()
}
a20 <- subset(data,annee==2020)
a21 <- subset(data, annee==2021)
a22 <- subset(data, annee==2022)
for (i in c(a20,a21,a22)) {
ggplot(data = i, aes(x=variete, y=rendement_MS))+
geom_bar()
}
for (i in c(2020,2021,2022)) {
ggplot(data = subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar()
}
for (i in c(2020,2021,2022)) {
ggplot(data = subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar()
}
ggplot(data = subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar()
for (i in c(2020,2021,2022)) {
ggplot(data = subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar()
}
ggplot(data = subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_point()
for (i in c(2020,2021,2022)) {
ggplot(data = subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_point()
}
ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_point()
for (i in c(2020,2021,2022)) {
ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_point()
}
for (i in c(2020,2021,2022)) {
ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar(stat = 'identity')
}
for (i in c(2020,2021,2022)) {
ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar(stat = 'identity')
}
for (i in c(2020,2021,2022)) {
ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar(stat = 'identity')
}
print(ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar(stat = 'identity'))
for (i in c(2020,2021,2022)) {
print(ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar(stat = 'identity'))
}
for (i in c(2020,2021,2022)) {
print(ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar())
}
for (i in c(2020,2021,2022)) {
print(ggplot(subset(data, annee==i), aes(x=variete, y=rendement_MS))+
geom_bar(stat = 'identity'))
}
ggplot(data,aes(x=variete,y=rendement_MS))+
geom_bar()+ facet_wrap(~annee)
ggplot(data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity')+ facet_wrap(~annee)
ggplot(data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity')+ facet_wrap(~annee)+
labs(x='Variété',
y='rendement [T/ha]')
data<- read_excel("Sorgho20_21_22_CIPF.xlsx")
head(data)
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
data<- read_excel("Sorgho20_21_22_CIPF.xlsx")
head(data)
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
ggplot(data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity')+ facet_wrap(~annee)+
labs(x='Variété',
y='rendement [T/ha]')
ggplot(data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity')+ facet_wrap(~annee)+
labs(x='Variété',
y='rendement [T/ha]')
library(readxl)
Sorgho20_21_22_CIPF <- read_excel("Sorgho20_21_22_CIPF.xlsx",
sheet = "pluvio")
View(Sorgho20_21_22_CIPF)
pluvio <- Sorgho20_21_22_CIPF <- read_excel("Sorgho20_21_22_CIPF.xlsx",+sheet="pluvio")
pluvio <- Sorgho20_21_22_CIPF <- read_excel("Sorgho20_21_22_CIPF.xlsx", + sheet = "pluvio")
pluvio <- read_excel("Sorgho20_21_22_CIPF.xlsx",+ sheet = "pluvio")
pluvio <- read_excel("Sorgho20_21_22_CIPF.xlsx",+ sheet = "pluvio")
library(readxl)
Sorgho20_21_22_CIPF <- read_excel("Sorgho20_21_22_CIPF.xlsx",
sheet = "pluvio")
View(Sorgho20_21_22_CIPF)
pluvio <- Sorgho20_21_22_CIPF <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio")
pluvio <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio")
temp <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "temp")
pluvio_temp <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
pluvio_temp <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
View(pluvio_temp)
pluvio_temp <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
View(pluvio_temp)
plot(pluvio_temp$Mois,pluvio_temp$precipitation)
barplot(pluvio_temp$Mois,pluvio_temp$precipitation)
ggplot(data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity')+ facet_wrap(~annee)+
labs(x='Variété',
y='rendement [T/ha]')
data<- read_excel("Sorgho20_21_22_CIPF.xlsx")
head(data)
ggplot(data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity')+ facet_wrap(~annee)+
labs(x='Variété',
y='rendement [T/ha]')
pluvio_temp <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
View(pluvio_temp)
meteo <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
ggplot(meteo)
ggplot(data=data,aes(x=variete,y=rendement_MS))+
geom_bar(stat = 'identity')+ facet_wrap(~annee)+
labs(x='Variété',
y='rendement [T/ha]')
ggplot(data=meteo)+
facet_wrap(~annee)+
geom_bar(aes(x=Mois,y=pluviometrie))
ggplot(data=meteo)+
facet_wrap(~annee)+
geom_bar(aes(x=Mois,y=pluviometrie),stat = 'identity')
ggplot(data=meteo)+
facet_wrap(~annee)+
geom_bar(aes(x=Mois,y=pluviometrie),stat = 'identity')+
geom_line(aes(x=Mois,y=temperature))
ggplot(data=meteo)+
facet_wrap(~annee)+
geom_bar(aes(x=Mois,y=pluviometrie),stat = 'identity')+
geom_point(aes(x=Mois,y=temperature))
View(meteo)
scale factor <- max(meteo$pluviometrie)/max(meteo$temperature)
scale_factor <- max(meteo$pluviometrie)/max(meteo$temperature)
scalefactor <- max(meteo$pluviometrie)/max(meteo$temperature)
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie),fill='blue')+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie),fill='blue')+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Food Security in Venezuela, Cereals Production and Food Gap", x = element_blank())
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie),fill='blue')+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie),fill='blue',position = position_nudge(x = -.4))+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie),fill='blue',position = position_nudge(x = -.4))+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
meteo <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
scalefactor <- max(meteo$pluviometrie)/max(meteo$temperature)
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie),fill='blue',position = position_nudge(x = -.4))+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie),fill='blue',position = position_nudge(x = -.4))+
geom_line(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),fill='blue',position = position_nudge(x = -.4))+
geom_line(aes(y=mean_temp),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
meteo <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
scalefactor <- max(meteo$pluviometrie)/max(meteo$temperature)
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),fill='blue',position = position_nudge(x = -.4))+
geom_line(aes(y=mean_temp),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
#2
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),fill='blue',position = position_nudge(x = -.4))+
geom_line(aes(y=mean_temp),col='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
#2
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain),fill='blue')+
geom_line(aes(y=mean_temp),col='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
#2
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain,width=0.5),fill='blue')+
geom_line(aes(y=mean_temp),col='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
#2
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain,width=0.5),fill='blue')+
geom_line(aes(y=mean_temp,width=2),col='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
warnings()
#2
scalefactor <- max(meteo$mean_rain)/max(meteo$mean_temp)
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain,width=0.5),fill='blue')+
geom_line(aes(y=mean_temp,width=2),col='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
#1
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie),fill='blue',position = position_nudge(x = -.4))+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
View(meteo)
#1
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=pluviometrie(l/m2)),fill='blue',position = position_nudge(x = -.4))+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
#1
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=meteo[,'pluviometrie(l/m2)']),fill='blue',position = position_nudge(x = -.4))+
geom_col(aes(y=temperature),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
#1
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=meteo[,'pluviometrie(l/m2)']),fill='blue',position = position_nudge(x = -.4))+
geom_col(aes(y=somme_temperature_base6),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
#1
ggplot(data=meteo,aes(x=Mois, width=.4))+
facet_wrap(~annee)+
geom_col(aes(y=meteo[,'pluviometrie(l/m2)']),fill='blue',position = position_nudge(x = -.4))+
geom_col(aes(y=meteo['somme_temperature_base6']),fill='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain,width=0.5),fill='blue')+
geom_line(aes(y=mean_temp,width=2),col='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
meteo <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
scalefactor <- max(meteo$mean_rain)/max(meteo$mean_temp)
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain,width=0.5),fill='blue')+
geom_line(aes(y=mean_temp,width=2),col='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
warnings()
rm(list=ls()) # Clean the workspace
library(pander)
library(readxl)
library(tidyverse)
library(knitr)
library(htmltools)
data<- read_excel("Sorgho20_21_22_CIPF.xlsx")
head(data)
cols_to_remove <- c('date_semis','date_recolte','lieu','precedent','traitement_semences','densite_semis')
data <- data[, ! names(data) %in% cols_to_remove, drop = F]
data$variete <- as.factor(data$variete)
pander(summary(data))
meteo <- read_excel("Sorgho20_21_22_CIPF.xlsx",sheet = "pluvio_temp")
scalefactor <- max(meteo$mean_rain)/max(meteo$mean_temp)
ggplot(data=meteo,aes(x=Mois))+
facet_wrap(~annee)+
geom_col(aes(y=mean_rain,width=0.5),fill='blue')+
geom_line(aes(y=mean_temp,width=2),col='red')+
scale_y_continuous(name='pluviometrie',sec.axis = sec_axis(~./scalefactor,name="temperature"))+
theme(
axis.title.y.left=element_text(color="blue"),
axis.text.y.left=element_text(color="blue"),
axis.title.y.right=element_text(color="red"),
axis.text.y.right=element_text(color="red")
) +
labs(title = "Temperature et pluviometrie", x = element_blank())
